<% content_for :title, 'Tous les entretiens' %>

<form action="<%= candidates_interviews_path %>" class="mt-3 mb-3">
  <input  class="form-control"
          type="text"
          placeholder="Recherche"
          name="search"
          value="<%= params[:search] %>">
</form>

<%= link_to 'Export (.xlsx)', candidates_interviews_path(format: :xlsx), class: 'btn btn-primary btn-sm' %>

<p><%= page_entries_info @candidates %></p>
<table class="table table-hover table-bordered mt-5">
<thead>
  <tr>
    <th></th>
    <th width="80">Numéro</th>
    <th width="120">Prénom</th>
    <th width="200">Nom</th>
    <th width="300">Baccalauréat</th>
    <th>Jury</th>
    <th>Décile</th>
    <th width="40">Note</th>
    <th>#</th>
    <th>PV</th>
  </tr>
</thead>
<tbody>
  <% @candidates.each_with_index do |candidate, index| %>
    <tr>
      <td class="small"><%= index + 1 %></td>
      <td><%= link_to candidate.number, candidates_interview_path(candidate) %></td>
      <td><%= candidate.first_name %></td>
      <td><%= candidate.last_name %></td>
      <td class="small"><%= candidate.baccalaureat %></td>
      <td class="small">
        <%= candidate.interviewers.join(', ') %>
        <% if candidate.interview_bonus %>
          <span class="badge badge-success">Coup de cœur</span>
        <% end %>
        
        <br/>
        (dossier <%= candidate.evaluations.map { |e| e.user.to_s }.join(', ') %>)
      </td>
      <td class="small
                <%= 'bg-danger' if candidate.decile_bad_surprise? %>
                <%= 'bg-success' if candidate.decile_good_surprise? %>
                ">
        <span class="badge badge-light">D<%= candidate.interview_decile %> entretien</span><br/>
        <% if candidate.selection_decile %>
          <span class="badge badge-light">D<%= candidate.selection_decile %> sélection</span>
        <% end %>
      </td>
      <td><b><%= candidate.interview_note.to_f.round %></b></td>
      <td><span class="badge badge-info"><%= candidate.interview_position %></span></td>
      <td><%= link_to 'PV',
                      candidates_print_interview_path(candidate),
                      class: 'btn btn-primary btn-sm' %></td>
    </tr>
  <% end %>
</tbody>
</table>
<%= paginate @candidates, theme: 'twitter-bootstrap-4' %>
